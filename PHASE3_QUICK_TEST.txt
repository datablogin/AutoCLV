# PHASE 3 QUICK TEST - Copy/Paste into Claude Desktop

## Setup (Run Once)
────────────────────────────────────────────────────────────────

PROMPT 1 - Health Check:
Can you check the health of the AutoCLV MCP server?

PROMPT 2 - Load Data (if needed):
I need to set up the AutoCLV analysis. Can you:
1. Build the customer data mart from synthetic_transactions.json
2. Calculate RFM metrics for Q1 2024 (Jan 1 - Mar 31)
3. Calculate RFM metrics for Q2 2024 (Apr 1 - Jun 30)
4. Create customer cohorts

PROMPT 3 - Verify Data:
Can you verify that the foundation data is ready? Check if the data mart, RFM metrics, and cohorts are available.

────────────────────────────────────────────────────────────────


## Test 1: Lens 2 Sankey Diagram
────────────────────────────────────────────────────────────────

PROMPT:
Run a Lens 2 period comparison analysis. I want to see customer migration patterns between the two periods.

WHAT TO LOOK FOR:
✓ Response includes "formatted_outputs" field
✓ Contains "lens2_sankey" with Plotly chart data
✓ Shows customer flow: Retained, Churned, New customers
✓ Metrics: retention_rate, growth_momentum, etc.

────────────────────────────────────────────────────────────────


## Test 2: Lens 3 Retention Chart
────────────────────────────────────────────────────────────────

PROMPT:
Analyze the cohort evolution for the first cohort. I want to see retention trends over time.

WHAT TO LOOK FOR:
✓ Response includes "lens3_retention_chart" in formatted_outputs
✓ Chart shows retention curve over 18+ periods
✓ Retention starts at 100% and decays over time
✓ Cohort maturity and LTV trajectory assessments

────────────────────────────────────────────────────────────────


## Test 3: Multi-Lens Executive Dashboard
────────────────────────────────────────────────────────────────

PROMPT:
Give me a comprehensive customer base health analysis. Run Lens 1 and Lens 5 together and show me an executive dashboard.

WHAT TO LOOK FOR:
✓ Both lens1 and lens5 in lenses_executed
✓ Contains "executive_dashboard" in formatted_outputs
✓ Dashboard combines data from multiple lenses
✓ 4-panel layout with health metrics

────────────────────────────────────────────────────────────────


## Test 4: Natural Language Query
────────────────────────────────────────────────────────────────

PROMPT:
How healthy is my customer base? Show me retention trends and growth momentum.

WHAT TO LOOK FOR:
✓ Automatically selects relevant lenses
✓ Returns formatted visualizations
✓ Synthesizes insights across lenses
✓ Provides actionable recommendations

────────────────────────────────────────────────────────────────


## Test 5: Performance Check
────────────────────────────────────────────────────────────────

PROMPT:
Run an orchestrated analysis with lens1, lens2, lens3, and lens5 all together.

WHAT TO LOOK FOR:
✓ All 4 lenses execute successfully
✓ execution_time_ms < 10000 (less than 10 seconds)
✓ Multiple formatted outputs (sankey, retention chart, dashboard)
✓ No errors or timeouts

────────────────────────────────────────────────────────────────


## QUICK VERIFICATION CHECKLIST
────────────────────────────────────────────────────────────────

After running all prompts, verify:

[ ] Lens 2 returns Sankey diagram (customer migration)
[ ] Lens 3 returns retention trend chart
[ ] Multi-lens returns executive dashboard
[ ] Charts have valid Plotly JSON structure
[ ] All metrics match between lens_result and formatted charts
[ ] Performance < 10 seconds for multi-lens analysis
[ ] No errors or crashes during any test
[ ] formatted_outputs field exists in all responses

────────────────────────────────────────────────────────────────


## EXPECTED RESPONSE STRUCTURE
────────────────────────────────────────────────────────────────

{
  "query": "...",
  "lenses_executed": ["lens2"],
  "formatted_outputs": {
    "lens2_sankey": { /* Plotly chart JSON */ },
    "lens3_retention_chart": { /* Plotly chart JSON */ },
    "executive_dashboard": { /* 4-panel dashboard JSON */ }
  },
  "lens2_result": { /* Detailed metrics */ },
  "insights": [ /* Key insights */ ],
  "recommendations": [ /* Actionable recommendations */ ],
  "execution_time_ms": 1234.56
}

────────────────────────────────────────────────────────────────


## TROUBLESHOOTING
────────────────────────────────────────────────────────────────

Problem: No formatted_outputs in response
Fix: Ensure MCP server is running Phase 3 code

Problem: Charts don't display
Fix: Check Plotly JSON structure is valid

Problem: Error about missing data
Fix: Run setup prompts to load data

Problem: Slow performance
Fix: Check data size, verify parallel execution

────────────────────────────────────────────────────────────────

END OF QUICK TEST
